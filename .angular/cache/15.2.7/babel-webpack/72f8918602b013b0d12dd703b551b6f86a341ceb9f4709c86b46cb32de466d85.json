{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../_services/product.service\";\nimport * as i2 from \"@angular/platform-browser\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nimport * as i9 from \"@angular/material/grid-list\";\nimport * as i10 from \"../drag.directive\";\nfunction AddNewProductComponent_button_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 23);\n    i0.ɵɵtext(1, \" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0442\\u043E\\u0432\\u0430\\u0440 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AddNewProductComponent_button_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 23);\n    i0.ɵɵtext(1, \" \\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u0442\\u043E\\u0432\\u0430\\u0440 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AddNewProductComponent_mat_grid_tile_40_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-grid-tile\")(1, \"div\", 24)(2, \"span\", 25);\n    i0.ɵɵlistener(\"click\", function AddNewProductComponent_mat_grid_tile_40_Template_span_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const i_r6 = restoredCtx.index;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.removeImage(i_r6));\n    });\n    i0.ɵɵtext(3, \"x\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"img\", 26);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const file_r5 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", file_r5.url, i0.ɵɵsanitizeUrl);\n  }\n}\nexport class AddNewProductComponent {\n  constructor(productService, sanitizer, activatedRoute, router) {\n    this.productService = productService;\n    this.sanitizer = sanitizer;\n    this.activatedRoute = activatedRoute;\n    this.router = router;\n    this.isNewProduct = true;\n    this.product = {\n      productId: null,\n      productName: '',\n      productDescription: '',\n      productDiscountedPrice: 0,\n      productActualPrice: 0,\n      productImages: []\n    };\n  }\n  ngOnInit() {\n    this.product = this.activatedRoute.snapshot.data['product'];\n    if (this.product && this.product.productId) {\n      this.isNewProduct = false;\n    }\n  }\n  addProduct(productForm) {\n    const productFormData = this.prepareFormData(this.product);\n    this.productService.addProduct(productFormData).subscribe(response => {\n      productForm.reset();\n      this.product.productImages = [];\n    }, error => {\n      console.log(error);\n    });\n  }\n  prepareFormData(product) {\n    const formData = new FormData();\n    formData.append('product', new Blob([JSON.stringify(product)], {\n      type: 'application/json'\n    }));\n    for (let i = 0; i < product.productImages.length; i++) {\n      formData.append('imageFile', product.productImages[i].file, product.productImages[i].file.name);\n    }\n    return formData;\n  }\n  onFileSelected(event) {\n    if (event.target.files) {\n      const file = event.target.files[0];\n      const fileHandle = {\n        file: file,\n        url: this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(file))\n      };\n      this.product.productImages.push(fileHandle);\n    }\n  }\n  removeImage(i) {\n    this.product.productImages.splice(i, 1);\n  }\n  fileDropped(fileHandle) {\n    this.product.productImages.push(fileHandle);\n  }\n}\nAddNewProductComponent.ɵfac = function AddNewProductComponent_Factory(t) {\n  return new (t || AddNewProductComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.DomSanitizer), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Router));\n};\nAddNewProductComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AddNewProductComponent,\n  selectors: [[\"app-add-new-product\"]],\n  decls: 41,\n  vars: 7,\n  consts: [[1, \"container\", \"mt-5\"], [1, \"card\", \"p-2\"], [1, \"row\"], [1, \"col-6\"], [3, \"ngSubmit\"], [\"productForm\", \"ngForm\"], [\"appearance\", \"outline\", 1, \"w-100\"], [\"name\", \"productName\", \"matInput\", \"\", \"placeholder\", \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"productDescription\", \"matInput\", \"\", \"placeholder\", \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"productActualPrice\", \"matInput\", \"\", \"placeholder\", \"\\u041E\\u0431\\u044B\\u0447\\u043D\\u0430\\u044F \\u0446\\u0435\\u043D\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"productDiscountedPrice\", \"matInput\", \"\", \"placeholder\", \"\\u0426\\u0435\\u043D\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430 \\u0441\\u043E \\u0441\\u043A\\u0438\\u0434\\u043A\\u043E\\u0439\", 3, \"ngModel\", \"ngModelChange\"], [\"align\", \"end\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", 2, \"margin-right\", \"3px\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 4, \"ngIf\"], [\"appDrag\", \"\", 1, \"dropzone\", 3, \"files\"], [1, \"text-wrapper\"], [1, \"centered\"], [1, \"browse-button\", 3, \"click\"], [\"type\", \"file\", \"multiple\", \"\", \"value\", \"select\", 2, \"display\", \"none\", 3, \"change\"], [\"selectFile\", \"\"], [1, \"mt-5\"], [\"cols\", \"4\", \"rowHeight\", \"1:1\"], [4, \"ngFor\", \"ngForOf\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", \"type\", \"submit\"], [2, \"position\", \"relative\"], [1, \"btn-remove-image\", 3, \"click\"], [\"width\", \"100px\", \"height\", \"100px\", 3, \"src\"]],\n  template: function AddNewProductComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r9 = i0.ɵɵgetCurrentView();\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"form\", 4, 5);\n      i0.ɵɵlistener(\"ngSubmit\", function AddNewProductComponent_Template_form_ngSubmit_4_listener() {\n        i0.ɵɵrestoreView(_r9);\n        const _r0 = i0.ɵɵreference(5);\n        return i0.ɵɵresetView(ctx.addProduct(_r0));\n      });\n      i0.ɵɵelementStart(6, \"mat-form-field\", 6)(7, \"mat-label\");\n      i0.ɵɵtext(8, \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"input\", 7);\n      i0.ɵɵlistener(\"ngModelChange\", function AddNewProductComponent_Template_input_ngModelChange_9_listener($event) {\n        return ctx.product.productName = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(10, \"mat-form-field\", 6)(11, \"mat-label\");\n      i0.ɵɵtext(12, \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"input\", 8);\n      i0.ɵɵlistener(\"ngModelChange\", function AddNewProductComponent_Template_input_ngModelChange_13_listener($event) {\n        return ctx.product.productDescription = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(14, \"mat-form-field\", 6)(15, \"mat-label\");\n      i0.ɵɵtext(16, \"\\u041E\\u0431\\u044B\\u0447\\u043D\\u0430\\u044F \\u0446\\u0435\\u043D\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"input\", 9);\n      i0.ɵɵlistener(\"ngModelChange\", function AddNewProductComponent_Template_input_ngModelChange_17_listener($event) {\n        return ctx.product.productActualPrice = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(18, \"mat-form-field\", 6)(19, \"mat-label\");\n      i0.ɵɵtext(20, \"\\u0426\\u0435\\u043D\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430 \\u0441\\u043E \\u0441\\u043A\\u0438\\u0434\\u043A\\u043E\\u0439\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(21, \"input\", 10);\n      i0.ɵɵlistener(\"ngModelChange\", function AddNewProductComponent_Template_input_ngModelChange_21_listener($event) {\n        return ctx.product.productDiscountedPrice = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(22, \"div\", 11)(23, \"button\", 12);\n      i0.ɵɵtext(24, \" \\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u044F \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(25, AddNewProductComponent_button_25_Template, 2, 0, \"button\", 13);\n      i0.ɵɵtemplate(26, AddNewProductComponent_button_26_Template, 2, 0, \"button\", 13);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(27, \"div\", 3)(28, \"div\")(29, \"div\", 14);\n      i0.ɵɵlistener(\"files\", function AddNewProductComponent_Template_div_files_29_listener($event) {\n        return ctx.fileDropped($event);\n      });\n      i0.ɵɵelementStart(30, \"div\", 15)(31, \"div\", 16);\n      i0.ɵɵtext(32, \" \\u041F\\u0435\\u0440\\u0435\\u0442\\u0430\\u0449\\u0438\\u0442\\u0435 \\u043A\\u0430\\u0440\\u0442\\u0438\\u043D\\u043A\\u0443 \\u0441\\u044E\\u0434\\u0430 \\u0438\\u043B\\u0438 \");\n      i0.ɵɵelementStart(33, \"a\", 17);\n      i0.ɵɵlistener(\"click\", function AddNewProductComponent_Template_a_click_33_listener() {\n        i0.ɵɵrestoreView(_r9);\n        const _r3 = i0.ɵɵreference(36);\n        return i0.ɵɵresetView(_r3.click());\n      });\n      i0.ɵɵtext(34, \"\\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0438\\u0437 \\u0444\\u0430\\u0439\\u043B\\u043E\\u0432\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(35, \"input\", 18, 19);\n      i0.ɵɵlistener(\"change\", function AddNewProductComponent_Template_input_change_35_listener($event) {\n        return ctx.onFileSelected($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(37, \"div\", 20)(38, \"div\", 2)(39, \"mat-grid-list\", 21);\n      i0.ɵɵtemplate(40, AddNewProductComponent_mat_grid_tile_40_Template, 5, 1, \"mat-grid-tile\", 22);\n      i0.ɵɵelementEnd()()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngModel\", ctx.product.productName);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.product.productDescription);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.product.productActualPrice);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.product.productDiscountedPrice);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.isNewProduct);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isNewProduct);\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngForOf\", ctx.product.productImages);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.NgModel, i5.NgForm, i6.MatButton, i7.MatFormField, i7.MatLabel, i8.MatInput, i9.MatGridList, i9.MatGridTile, i10.DragDirective],\n  styles: [\"mat-grid-tile[_ngcontent-%COMP%] {\\r\\n  border: 1px solid #eee;\\r\\n}\\r\\n\\r\\n.btn-remove-image[_ngcontent-%COMP%] {\\r\\n  position: absolute;\\r\\n  cursor: pointer;\\r\\n  top: -10px;\\r\\n  right: -10px;\\r\\n  background-color: red;\\r\\n  color: white;\\r\\n  border-radius: 50%;\\r\\n  width: 20px;\\r\\n  height: auto;\\r\\n  text-align: center;\\r\\n}\\r\\n\\r\\n.dropzone[_ngcontent-%COMP%] {\\r\\n  height: 150px;\\r\\n  min-width: 100px;\\r\\n  width: 400px;\\r\\n  display: table;\\r\\n  background-color: #eee;\\r\\n  border: dashed 1px #aaa;\\r\\n  border-radius: 10px;\\r\\n  margin-left: auto;\\r\\n  margin-right: auto;\\r\\n}\\r\\n\\r\\n.text-wrapper[_ngcontent-%COMP%] {\\r\\n  display: table-cell;\\r\\n  vertical-align: middle;\\r\\n}\\r\\n\\r\\n.centered[_ngcontent-%COMP%] {\\r\\n  text-align: center;\\r\\n}\\r\\n\\r\\n.browse-button[_ngcontent-%COMP%] {\\r\\n  cursor: pointer;\\r\\n  color: blue;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvYWRkLW5ldy1wcm9kdWN0L2FkZC1uZXctcHJvZHVjdC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0Usc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLGVBQWU7RUFDZixVQUFVO0VBQ1YsWUFBWTtFQUNaLHFCQUFxQjtFQUNyQixZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLFdBQVc7RUFDWCxZQUFZO0VBQ1osa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsYUFBYTtFQUNiLGdCQUFnQjtFQUNoQixZQUFZO0VBQ1osY0FBYztFQUNkLHNCQUFzQjtFQUN0Qix1QkFBdUI7RUFDdkIsbUJBQW1CO0VBQ25CLGlCQUFpQjtFQUNqQixrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxtQkFBbUI7RUFDbkIsc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsZUFBZTtFQUNmLFdBQVc7QUFDYiIsInNvdXJjZXNDb250ZW50IjpbIm1hdC1ncmlkLXRpbGUge1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICNlZWU7XHJcbn1cclxuXHJcbi5idG4tcmVtb3ZlLWltYWdlIHtcclxuICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIHRvcDogLTEwcHg7XHJcbiAgcmlnaHQ6IC0xMHB4O1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHJlZDtcclxuICBjb2xvcjogd2hpdGU7XHJcbiAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gIHdpZHRoOiAyMHB4O1xyXG4gIGhlaWdodDogYXV0bztcclxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbn1cclxuXHJcbi5kcm9wem9uZSB7XHJcbiAgaGVpZ2h0OiAxNTBweDtcclxuICBtaW4td2lkdGg6IDEwMHB4O1xyXG4gIHdpZHRoOiA0MDBweDtcclxuICBkaXNwbGF5OiB0YWJsZTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWVlO1xyXG4gIGJvcmRlcjogZGFzaGVkIDFweCAjYWFhO1xyXG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XHJcbiAgbWFyZ2luLWxlZnQ6IGF1dG87XHJcbiAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xyXG59XHJcblxyXG4udGV4dC13cmFwcGVyIHtcclxuICBkaXNwbGF5OiB0YWJsZS1jZWxsO1xyXG4gIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XHJcbn1cclxuXHJcbi5jZW50ZXJlZCB7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcblxyXG4uYnJvd3NlLWJ1dHRvbiB7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIGNvbG9yOiBibHVlO1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","AddNewProductComponent","constructor","productService","sanitizer","activatedRoute","router","productId","productName","productDescription","productDiscountedPrice","productActualPrice","productImages","ngOnInit","product","snapshot","data","isNewProduct","addProduct","productForm","productFormData","prepareFormData","subscribe","response","reset","error","console","log","formData","FormData","append","Blob","JSON","stringify","type","i","length","file","name","onFileSelected","event","target","files","fileHandle","url","bypassSecurityTrustUrl","window","URL","createObjectURL","push","removeImage","splice","fileDropped","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\hit\\Git\\Course-work.-Construction-materials-store-FRONT-end\\src\\app\\add-new-product\\add-new-product.component.html","C:\\hit\\Git\\Course-work.-Construction-materials-store-FRONT-end\\src\\app\\add-new-product\\add-new-product.component.ts"],"sourcesContent":["<div class=\"container mt-5\">\r\n  <div class=\"card p-2\">\r\n    <div class=\"row\">\r\n      <div class=\"col-6\">\r\n        <form #productForm=\"ngForm\" (ngSubmit)=\"addProduct(productForm)\">\r\n          <mat-form-field appearance=\"outline\" class=\"w-100\">\r\n            <mat-label>Название товара</mat-label>\r\n            <input\r\n              [(ngModel)]=\"product.productName\"\r\n              name=\"productName\"\r\n              matInput\r\n              placeholder=\"Название товара\"\r\n            />\r\n          </mat-form-field>\r\n          <mat-form-field appearance=\"outline\" class=\"w-100\">\r\n            <mat-label>Описание товара</mat-label>\r\n            <input\r\n              [(ngModel)]=\"product.productDescription\"\r\n              name=\"productDescription\"\r\n              matInput\r\n              placeholder=\"Описание товара\"\r\n            />\r\n          </mat-form-field>\r\n          <mat-form-field appearance=\"outline\" class=\"w-100\">\r\n            <mat-label>Обычная цена товара</mat-label>\r\n            <input\r\n              [(ngModel)]=\"product.productActualPrice\"\r\n              name=\"productActualPrice\"\r\n              matInput\r\n              placeholder=\"Обычная цена товара\"\r\n            />\r\n          </mat-form-field>\r\n          <mat-form-field appearance=\"outline\" class=\"w-100\">\r\n            <mat-label>Цена товара со скидкой</mat-label>\r\n            <input\r\n              [(ngModel)]=\"product.productDiscountedPrice\"\r\n              name=\"productDiscountedPrice\"\r\n              matInput\r\n              placeholder=\"Цена товара со скидкой\"\r\n            />\r\n          </mat-form-field>\r\n\r\n          <div align=\"end\">\r\n            <button\r\n              mat-stroked-button\r\n              color=\"primary\"\r\n              style=\"margin-right: 3px\"\r\n            >\r\n              Очистить поля\r\n            </button>\r\n            <button\r\n              mat-stroked-button\r\n              color=\"primary\"\r\n              type=\"submit\"\r\n              *ngIf=\"isNewProduct\"\r\n            >\r\n              Добавить товар\r\n            </button>\r\n            <button\r\n              mat-stroked-button\r\n              color=\"primary\"\r\n              type=\"submit\"\r\n              *ngIf=\"!isNewProduct\"\r\n            >\r\n              Обновить товар\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n      <div class=\"col-6\">\r\n        <div>\r\n          <div class=\"dropzone\" appDrag (files)=\"fileDropped($event)\">\r\n            <div class=\"text-wrapper\">\r\n              <div class=\"centered\">\r\n                Перетащите картинку сюда или\r\n                <a (click)=\"selectFile.click()\" class=\"browse-button\"\r\n                  >выберите из файлов</a\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <input\r\n            type=\"file\"\r\n            multiple\r\n            value=\"select\"\r\n            #selectFile\r\n            (change)=\"onFileSelected($event)\"\r\n            style=\"display: none\"\r\n          />\r\n        </div>\r\n        <div class=\"mt-5\">\r\n          <div class=\"row\">\r\n            <mat-grid-list cols=\"4\" rowHeight=\"1:1\">\r\n              <mat-grid-tile\r\n                *ngFor=\"let file of product.productImages; let i = index\"\r\n              >\r\n                <div style=\"position: relative\">\r\n                  <span class=\"btn-remove-image\" (click)=\"removeImage(i)\"\r\n                    >x</span\r\n                  >\r\n                  <img [src]=\"file.url\" width=\"100px\" height=\"100px\" />\r\n                </div>\r\n              </mat-grid-tile>\r\n            </mat-grid-list>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Product } from '../_model/product.model';\r\nimport { NgForm } from '@angular/forms';\r\nimport { ProductService } from '../_services/product.service';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { FileHandle } from '../_model/file-handle.model';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-add-new-product',\r\n  templateUrl: './add-new-product.component.html',\r\n  styleUrls: ['./add-new-product.component.css'],\r\n})\r\nexport class AddNewProductComponent {\r\n  isNewProduct = true;\r\n\r\n  product: Product = {\r\n    productId: null,\r\n    productName: '',\r\n    productDescription: '',\r\n    productDiscountedPrice: 0,\r\n    productActualPrice: 0,\r\n    productImages: [],\r\n  };\r\n\r\n  constructor(\r\n    private productService: ProductService,\r\n    private sanitizer: DomSanitizer,\r\n    private activatedRoute: ActivatedRoute,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.product = this.activatedRoute.snapshot.data['product'];\r\n\r\n    if (this.product && this.product.productId) {\r\n      this.isNewProduct = false;\r\n    }\r\n  }\r\n\r\n  addProduct(productForm: NgForm) {\r\n    const productFormData = this.prepareFormData(this.product);\r\n\r\n    this.productService.addProduct(productFormData).subscribe(\r\n      (response: Product) => {\r\n        productForm.reset();\r\n        this.product.productImages = [];\r\n      },\r\n      (error: HttpErrorResponse) => {\r\n        console.log(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  prepareFormData(product: Product): FormData {\r\n    const formData = new FormData();\r\n\r\n    formData.append(\r\n      'product',\r\n      new Blob([JSON.stringify(product)], { type: 'application/json' })\r\n    );\r\n\r\n    for (let i = 0; i < product.productImages.length; i++) {\r\n      formData.append(\r\n        'imageFile',\r\n        product.productImages[i].file,\r\n        product.productImages[i].file.name\r\n      );\r\n    }\r\n\r\n    return formData;\r\n  }\r\n\r\n  onFileSelected(event: any) {\r\n    if (event.target.files) {\r\n      const file = event.target.files[0];\r\n\r\n      const fileHandle: FileHandle = {\r\n        file: file,\r\n        url: this.sanitizer.bypassSecurityTrustUrl(\r\n          window.URL.createObjectURL(file)\r\n        ),\r\n      };\r\n\r\n      this.product.productImages.push(fileHandle);\r\n    }\r\n  }\r\n\r\n  removeImage(i: number) {\r\n    this.product.productImages.splice(i, 1);\r\n  }\r\n\r\n  fileDropped(fileHandle: FileHandle) {\r\n    this.product.productImages.push(fileHandle);\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}